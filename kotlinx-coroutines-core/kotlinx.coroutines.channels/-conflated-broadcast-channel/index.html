<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ConflatedBroadcastChannel - kotlinx-coroutines-core</title>
  <meta name="description" content="Library support for kotlin coroutines">
  <link rel="stylesheet" href="/kotlinx.coroutines/assets/main.css">
  <link rel="canonical" href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines.channels/-conflated-broadcast-channel/">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="/kotlinx.coroutines/assets/js/api.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-47631155-3', 'auto');
    ga('send', 'pageview');
  </script>
</head>

  <body>
    <header class="site-header" role="banner">
  <div class="wrapper">
    <a class="site-title" href="/kotlinx.coroutines/">kotlinx.coroutines</a>
  </div>
</header>

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="api-docs-breadcrumbs"><a href="../../index.html">kotlinx-coroutines-core</a> / <a href="../index.html">kotlinx.coroutines.channels</a> / <a href="./index.html">ConflatedBroadcastChannel</a></div>

<h1 id="conflatedbroadcastchannel">ConflatedBroadcastChannel</h1>

<div class="signature"><code><span class="identifier">@ExperimentalCoroutinesApi</span> <span class="keyword">class </span><span class="identifier">ConflatedBroadcastChannel</span><span class="symbol">&lt;</span><span class="identifier">E</span><span class="symbol">&gt;</span>&nbsp;<span class="symbol">:</span>&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<a href="../-broadcast-channel/index.html"><span class="identifier">BroadcastChannel</span></a><span class="symbol">&lt;</span><a href="index.html#E"><span class="identifier">E</span></a><span class="symbol">&gt;</span></code> <a href="https://github.com/kotlin/kotlinx.coroutines/tree/master/kotlinx-coroutines-core/common/src/channels/ConflatedBroadcastChannel.kt#L33">(source)</a></div>

<p>Broadcasts the most recently sent element (aka <a href="value.html">value</a>) to all <a href="open-subscription.html">openSubscription</a> subscribers.</p>

<p>Back-to-send sent elements are <em>conflated</em> – only the the most recently sent value is received,
while previously sent elements <strong>are lost</strong>.
Every subscriber immediately receives the most recently sent element.
Sender to this broadcast channel never suspends and <a href="offer.html">offer</a> always returns <code>true</code>.</p>

<p>A secondary constructor can be used to create an instance of this class that already holds a value.
This channel is also created by <code>BroadcastChannel(Channel.CONFLATED)</code> factory function invocation.</p>

<p>This implementation is fully lock-free. In this implementation
<a href="open-subscription.html">opening</a> and <a href="../-receive-channel/cancel.html">closing</a> subscription takes O(N) time, where N is the
number of subscribers.</p>

<p><strong>Note: This API is experimental.</strong> It may be changed in the future updates.</p>

<h3 id="constructors">Constructors</h3>

<table class="api-docs-table">
<tbody>
<tr>
<td>

        <p><a href="-init-.html">&lt;init&gt;</a></p>

      </td>
<td>
        <div class="signature"><code><span class="identifier">ConflatedBroadcastChannel</span><span class="symbol">(</span><span class="parameterName" id="kotlinx.coroutines.channels.ConflatedBroadcastChannel$&lt;init&gt;(kotlinx.coroutines.channels.ConflatedBroadcastChannel.E)/value">value</span><span class="symbol">:</span>&nbsp;<a href="index.html#E"><span class="identifier">E</span></a><span class="symbol">)</span></code></div>

        <p>Creates an instance of this class that already holds a value.</p>

        <div class="signature"><code><span class="identifier">ConflatedBroadcastChannel</span><span class="symbol">(</span><span class="symbol">)</span></code></div>

        <p>Broadcasts the most recently sent element (aka <a href="value.html">value</a>) to all <a href="open-subscription.html">openSubscription</a> subscribers.</p>

      </td>
</tr>
</tbody>
</table>

<h3 id="properties">Properties</h3>

<table class="api-docs-table">
<tbody>
<tr>
<td>

        <p><a href="is-closed-for-send.html">isClosedForSend</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">val </span><span class="identifier">isClosedForSend</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html"><span class="identifier">Boolean</span></a></code></div>

        <p>Returns <code>true</code> if this channel was closed by an invocation of <a href="close.html">close</a>. This means that
calling <a href="send.html">send</a> or <a href="offer.html">offer</a> will result in an exception.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="on-send.html">onSend</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">val </span><span class="identifier">onSend</span><span class="symbol">: </span><a href="../../kotlinx.coroutines.selects/-select-clause2.html"><span class="identifier">SelectClause2</span></a><span class="symbol">&lt;</span><a href="index.html#E"><span class="identifier">E</span></a><span class="symbol">,</span>&nbsp;<a href="../-send-channel/index.html"><span class="identifier">SendChannel</span></a><span class="symbol">&lt;</span><a href="index.html#E"><span class="identifier">E</span></a><span class="symbol">&gt;</span><span class="symbol">&gt;</span></code></div>

        <p>Clause for the <a href="../../kotlinx.coroutines.selects/select.html">select</a> expression of the <a href="send.html">send</a> suspending function that selects when the element that is specified
as the parameter is sent to the channel. When the clause is selected, the reference to this channel
is passed into the corresponding block.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="value.html">value</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">val </span><span class="identifier">value</span><span class="symbol">: </span><a href="index.html#E"><span class="identifier">E</span></a></code></div>

        <p>The most recently sent element to this channel.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="value-or-null.html">valueOrNull</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">val </span><span class="identifier">valueOrNull</span><span class="symbol">: </span><a href="index.html#E"><span class="identifier">E</span></a><span class="symbol">?</span></code></div>

        <p>The most recently sent element to this channel or <code>null</code> when this class is constructed without
initial value and no value was sent yet or if it was <a href="close.html">closed</a>.</p>

      </td>
</tr>
</tbody>
</table>

<h3 id="functions">Functions</h3>

<table class="api-docs-table">
<tbody>
<tr>
<td>

        <p><a href="cancel.html">cancel</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">fun </span><span class="identifier">cancel</span><span class="symbol">(</span><span class="parameterName" id="kotlinx.coroutines.channels.ConflatedBroadcastChannel$cancel(kotlinx.coroutines.CancellationException)/cause">cause</span><span class="symbol">:</span>&nbsp;<a href="../../kotlinx.coroutines/-cancellation-exception/index.html"><span class="identifier">CancellationException</span></a><span class="symbol">?</span><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a></code></div>

        <p>Cancels this conflated broadcast channel with an optional cause, same as <a href="close.html">close</a>.
This function closes the channel with
the specified cause (unless it was already closed),
and <a href="../-receive-channel/cancel.html">cancels</a> all open subscriptions.
A cause can be used to specify an error message or to provide other details on
a cancellation reason for debugging purposes.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="close.html">close</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">fun </span><span class="identifier">close</span><span class="symbol">(</span><span class="parameterName" id="kotlinx.coroutines.channels.ConflatedBroadcastChannel$close(kotlin.Throwable)/cause">cause</span><span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-throwable/index.html"><span class="identifier">Throwable</span></a><span class="symbol">?</span><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html"><span class="identifier">Boolean</span></a></code></div>

        <p>Closes this channel.
This is an idempotent operation — subsequent invocations of this function have no effect and return <code>false</code>.
Conceptually, its sends a special “close token” over this channel.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="invoke-on-close.html">invokeOnClose</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">fun </span><span class="identifier">invokeOnClose</span><span class="symbol">(</span><span class="parameterName" id="kotlinx.coroutines.channels.ConflatedBroadcastChannel$invokeOnClose(kotlin.Function1((kotlin.Throwable, kotlin.Unit)))/handler">handler</span><span class="symbol">:</span>&nbsp;<span class="identifier">Handler</span><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a></code></div>

        <p>Registers a <a href="invoke-on-close.html#kotlinx.coroutines.channels.ConflatedBroadcastChannel$invokeOnClose(kotlin.Function1((kotlin.Throwable, kotlin.Unit)))/handler">handler</a> which is synchronously invoked once the channel is <a href="close.html">closed</a>
or the receiving side of this channel is <a href="../-receive-channel/cancel.html">cancelled</a>.
Only one handler can be attached to a channel during its lifetime.
The <code>handler</code> is invoked when <a href="is-closed-for-send.html">isClosedForSend</a> starts to return <code>true</code>.
If the channel is closed already, the handler is invoked immediately.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="offer.html">offer</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">fun </span><span class="identifier">offer</span><span class="symbol">(</span><span class="parameterName" id="kotlinx.coroutines.channels.ConflatedBroadcastChannel$offer(kotlinx.coroutines.channels.ConflatedBroadcastChannel.E)/element">element</span><span class="symbol">:</span>&nbsp;<a href="index.html#E"><span class="identifier">E</span></a><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html"><span class="identifier">Boolean</span></a></code></div>

        <p>Sends the value to all subscribed receives and stores this value as the most recent state for
future subscribers. This implementation always returns <code>true</code>.
It throws exception if the channel <a href="is-closed-for-send.html">isClosedForSend</a> (see <a href="close.html">close</a> for details).</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="open-subscription.html">openSubscription</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">fun </span><span class="identifier">openSubscription</span><span class="symbol">(</span><span class="symbol">)</span><span class="symbol">: </span><a href="../-receive-channel/index.html"><span class="identifier">ReceiveChannel</span></a><span class="symbol">&lt;</span><a href="index.html#E"><span class="identifier">E</span></a><span class="symbol">&gt;</span></code></div>

        <p>Subscribes to this <a href="../-broadcast-channel/index.html">BroadcastChannel</a> and returns a channel to receive elements from it.
The resulting channel shall be <a href="../-receive-channel/cancel.html">cancelled</a> to unsubscribe from this
broadcast channel.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="send.html">send</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">suspend</span> <span class="keyword">fun </span><span class="identifier">send</span><span class="symbol">(</span><span class="parameterName" id="kotlinx.coroutines.channels.ConflatedBroadcastChannel$send(kotlinx.coroutines.channels.ConflatedBroadcastChannel.E)/element">element</span><span class="symbol">:</span>&nbsp;<a href="index.html#E"><span class="identifier">E</span></a><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a></code></div>

        <p>Sends the value to all subscribed receives and stores this value as the most recent state for
future subscribers. This implementation never suspends.
It throws exception if the channel <a href="is-closed-for-send.html">isClosedForSend</a> (see <a href="close.html">close</a> for details).</p>

      </td>
</tr>
</tbody>
</table>

<h3 id="extension-functions">Extension Functions</h3>

<table class="api-docs-table">
<tbody>
<tr>
<td>

        <p><a href="../../kotlinx.coroutines.flow/as-flow.html">asFlow</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">fun </span><span class="symbol">&lt;</span><span class="identifier">T</span><span class="symbol">&gt;</span> <a href="../-broadcast-channel/index.html"><span class="identifier">BroadcastChannel</span></a><span class="symbol">&lt;</span><a href="../../kotlinx.coroutines.flow/as-flow.html#T"><span class="identifier">T</span></a><span class="symbol">&gt;</span><span class="symbol">.</span><span class="identifier">asFlow</span><span class="symbol">(</span><span class="symbol">)</span><span class="symbol">: </span><a href="../../kotlinx.coroutines.flow/-flow/index.html"><span class="identifier">Flow</span></a><span class="symbol">&lt;</span><a href="../../kotlinx.coroutines.flow/as-flow.html#T"><span class="identifier">T</span></a><span class="symbol">&gt;</span></code></div>

        <p>Represents the given broadcast channel as a hot flow.
Every flow collector will trigger a new broadcast channel subscription.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="../consume.html">consume</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">fun </span><span class="symbol">&lt;</span><span class="identifier">E</span><span class="symbol">, </span><span class="identifier">R</span><span class="symbol">&gt;</span> <a href="../-broadcast-channel/index.html"><span class="identifier">BroadcastChannel</span></a><span class="symbol">&lt;</span><a href="../consume.html#E"><span class="identifier">E</span></a><span class="symbol">&gt;</span><span class="symbol">.</span><span class="identifier">consume</span><span class="symbol">(</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="parameterName" id="kotlinx.coroutines.channels$consume(kotlinx.coroutines.channels.BroadcastChannel((kotlinx.coroutines.channels.consume.E)), kotlin.Function1((kotlinx.coroutines.channels.ReceiveChannel((kotlinx.coroutines.channels.consume.E)), kotlinx.coroutines.channels.consume.R)))/block">block</span><span class="symbol">:</span>&nbsp;<a href="../-receive-channel/index.html"><span class="identifier">ReceiveChannel</span></a><span class="symbol">&lt;</span><a href="../consume.html#E"><span class="identifier">E</span></a><span class="symbol">&gt;</span><span class="symbol">.</span><span class="symbol">(</span><span class="symbol">)</span>&nbsp;<span class="symbol">-&gt;</span>&nbsp;<a href="../consume.html#R"><span class="identifier">R</span></a><br /><span class="symbol">)</span><span class="symbol">: </span><a href="../consume.html#R"><span class="identifier">R</span></a></code></div>

        <p>Opens subscription to this <a href="../-broadcast-channel/index.html">BroadcastChannel</a> and makes sure that the given <a href="../consume.html#kotlinx.coroutines.channels$consume(kotlinx.coroutines.channels.BroadcastChannel((kotlinx.coroutines.channels.consume.E)), kotlin.Function1((kotlinx.coroutines.channels.ReceiveChannel((kotlinx.coroutines.channels.consume.E)), kotlinx.coroutines.channels.consume.R)))/block">block</a> consumes all elements
from it by always invoking <a href="../-receive-channel/cancel.html">cancel</a> after the execution of the block.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="../consume-each.html">consumeEach</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">suspend</span> <span class="keyword">fun </span><span class="symbol">&lt;</span><span class="identifier">E</span><span class="symbol">&gt;</span> <a href="../-broadcast-channel/index.html"><span class="identifier">BroadcastChannel</span></a><span class="symbol">&lt;</span><a href="../consume-each.html#E"><span class="identifier">E</span></a><span class="symbol">&gt;</span><span class="symbol">.</span><span class="identifier">consumeEach</span><span class="symbol">(</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="parameterName" id="kotlinx.coroutines.channels$consumeEach(kotlinx.coroutines.channels.BroadcastChannel((kotlinx.coroutines.channels.consumeEach.E)), kotlin.Function1((kotlinx.coroutines.channels.consumeEach.E, kotlin.Unit)))/action">action</span><span class="symbol">:</span>&nbsp;<span class="symbol">(</span><a href="../consume-each.html#E"><span class="identifier">E</span></a><span class="symbol">)</span>&nbsp;<span class="symbol">-&gt;</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a><br /><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a></code></div>

        <p>Subscribes to this <a href="../-broadcast-channel/index.html">BroadcastChannel</a> and performs the specified action for each received element.</p>

      </td>
</tr>
</tbody>
</table>

      </div>
    </main>
    <footer class="site-footer">
  <!-- empty -->
</footer>

  </body>
</html>

